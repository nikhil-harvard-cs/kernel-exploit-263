This exploit for CVE-2021-22555 was developed on Linux kernel version 5.8.0-48-generic (5.8.0-48-generic #54~20.04.1-Ubuntu)
For some reason it works best when I ssh into the debug machine and run the exploit in my ssh session.  IDK why.  The online POC is more stable in this regard.


Random notes I took while working through this:
-------------------------------------------------------
From gdb,
exploit calls struct xt\_table\_info \*xt\_alloc\_table\_info(0xfb6), which calls kvmalloc(0xff6, GFP\_KERNEL\_ACCOUNT)
Thus the source implies that sizeof(struct xt\_table\_info) = 64
The allocated buffer with size 0xff6 contains a struct xt\_table\_info with info-\>size set to 0xfb6, and the 0xfb6 bytes follow immediately after the struct xt\_table\_info

somehow again the exploit calls struct xt\_table\_info \*xt\_alloc\_table\_info(0xfbe) which calls kvmalloc(0xffe, GFP\_KERNEL\_ACCOUNT) which returns a page aligned address.
This second time, memset is leveraged to write the 4 bytes of zeroes at the end of of the 0xffe chunk allocated struct xt\_table\_info.  Thus the write straddles the page boundary, overflowing 2 null bytes into the next page.
