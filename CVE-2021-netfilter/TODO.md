The save\_state function should be moved to the main exploit source file, and the build\_ropchain function should be moved to exploitlib, with the proper define guards for kernel 5.8.0-48-generic.  Be careful to not mix up 32 bit and 64 bit registers and their sizes when merging.

Merging may be helpful once the target.mk can be made to compile the 32 bit exploit binary properly, since target.mk includes exploitlib.  Once this is done, the Makefile should be changed to target.mk

Another thing that could be done is abusing the UAF in the library itself, for example, moving the code to a function like uaf1024 (exploiting UAF using objects in the kmalloc-1024 slab) and hardcoding offsets for different kernel versions (like the offsets for anon\_pipe\_ops from the kernel base address).  IDK yet how much the general UAF-1024 exploitation strategy might change with different kernel versions, but apart from offsets from the kernel base address, I do not think anything else should change between kernel versions.
