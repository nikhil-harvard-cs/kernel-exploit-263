import os

def read_proc_file(file_path):
    try:
        with open(file_path, "r") as file:
            return file.read()
    except Exception as e:
        print(f"Error reading {file_path}: {e}")
        return None

def is_kaslr_enabled():
    cmdline = read_proc_file("/proc/cmdline")
    if cmdline is None:
        return None
    elif "kaslr" in cmdline:
        if "nokslr" in cmdline:
            return False
        else:
            return True
    else:
        return False

def is_smep_enabled():
    cpuinfo = read_proc_file("/proc/cpuinfo")
    if cpuinfo is None:
        return None
    elif "smep" in cpuinfo:
        if "nosmep" in cpuinfo:
            return False
        else:
            return True
    else:
        return False

def is_smap_enabled():
    cpuinfo = read_proc_file("/proc/cpuinfo")
    if cpuinfo is None:
        return None
    elif "smap" in cpuinfo:
        if "nosmap" in cpuinfo:
            return False
        else:
            return True
    else:
        return False