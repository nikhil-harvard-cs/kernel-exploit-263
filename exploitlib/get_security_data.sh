#!/bin/bash

# Function to check if Lynis is installed
check_lynis_installed() {
    if ! command -v lynis &> /dev/null; then
        echo "Lynis not installed. Installing now..."
        sudo apt-get update
        sudo apt-get install lynis -y
    else
        echo "Lynis is already installed."
    fi
}

# Prompt the user for the filename for the audit report
echo "Enter the filename for the Lynis audit report:"
read file_name

# Check if Lynis is installed, install if not
check_lynis_installed

# Run Lynis audit
sudo lynis audit system --pentest --log-file $file_name

# Execute the Python scripts
python map_to_exploit.py
python security_suggestions.py $file_name

echo "Script execution completed."
